---
title: 数据库基础知识
date: 2020-11-3
---


# 数据库基础

## ACID
+ 原子性(Atomicity)  
事务被视为不可分割的最小单元，事物的所有操作要么全部提交成功，要么全部失败回滚。  
比如银行转账，从A账户转100元至B账户，分为两个步骤：1）从A账户取100元；2）存入100元至B账户。这两步要么一起完成，要么一起不完成，如果只完成第一步，第二步失败，钱会莫名其妙少了100元。  

+ 一致性(Consistency)  
一致性是指数据库在事务执行前后都保持一致性状态。在一致性状态下，所有事务对同一个数据的读取结果都是相同的。  
  
  事务的运行不会改变数据库原本的一致性约束。例如现在有完整性约束a+b=10，如果一个事务改变了a，那么必须得改变b，使得事务结束后依然满足a+b=10，否则事务失败。


+ 隔离性、独立性(Isolation)  
所谓独立性是指并发的事务之间不会互相影响，如果一个一个事务所做的修改在最终提交以前，对其它事务时不可见的。  

  比如现在有个交易是从A账户转100元至B账户，在这个交易还未完成的情况下，如果此时B查询自己的账户，是看不到新增加的100元的。

+ 持久性(Durability)  
一旦事务提交，则其所做的修改将会永远保存到数据库中，即使系统发生崩溃，事务执行的结果也不能丢失。

---- 

* 只有满足一致性，事务结果才是正确的
* 在无并发的情况，事务串行执行，隔离性一定能够满足。此时只要能满足原子性，就一定能满足一致性。
* 在并发的情况下，多个事务并行执行，事务不仅要满足原子性，还需要满足隔离性，才能满足一致性。
* 持久性是为了能够应对系统崩溃的情况。

---  


## CAP定理（CAP theorem） 

在计算机科学中, CAP定理（CAP theorem）, 又被称作 布鲁尔定理（Brewer's theorem）, 它指出对于一个分布式计算系统来说，不可能同时满足以下三点:

+ 一致性(Consistency) (所有节点在同一时间具有相同的数据)
+ 可用性(Availability) (保证每个请求不管成功或者失败都有响应)
+ 分隔容忍(Partition tolerance) (系统中任意信息的丢失或失败不会影响系统的继续运作)  

CAP理论的核心是：一个分布式系统不可能同时很好的满足一致性，可用性和分区容错性这三个需求，最多只能同时较好的满足两个。

因此，根据 CAP 原理将 NoSQL 数据库分成了满足 CA 原则、满足 CP 原则和满足 AP 原则三 大类：

+ CA - 单点集群，满足一致性，可用性的系统，通常在可扩展性上不太强大。
+ CP - 满足一致性，分区容忍性的系统，通常性能不是特别高。
+ AP - 满足可用性，分区容忍性的系统，通常可能对一致性要求低一些。  

![cap](cap.png)  
